#!/usr/bin/env python
from os.path import basename
from pathlib import Path
from sys import argv, stderr
import sys

from app.utils import decrypt

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print(
            f"Usage: {basename(__file__)} <fileId> <password>", file=stderr
        )
        sys.exit(-1)

    file_id, password = argv[1:]
    result = decrypt(file_id, password)
    print(result)
    (Path.home() / "tmp" / result.filename).write_bytes(result.buffer.getvalue())
